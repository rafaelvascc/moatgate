$(function(){function u(n){this.index=n;this.id=0;this.type="";this.value="";this.expiration=moment().add(30,"d").format("YYYY-MM-DD");this.description=""}function f(n){this.index=n;this.id=0;this.name="";this.displayName="";this.description="";this.required=!1;this.emphasize=!1;this.showInDiscoveryDocument=!0;this.userScopes=[]}function h(){for(var e,r,i,u,f=t.find("tr"),n=0;n<f.length;n++)for(e=$(f[n]),r=e.find("[name^='Client.ClientSecrets[']"),i=0;i<r.length;i++)u=$(r[i]),u.attr("name",u.attr("name").replace(/\[([1-9]\d*)\]/,"["+n+"]"))}function v(){for(var r,c,i,u,e,o,f,s,h=n.find("tr.scopeValues"),t=0;t<h.length;t++){for(r=$(h[t]),c=r.attr("data-index"),r.attr("data-index",t),i=r.find("[name^='ApiResource.Scopes[']"),u=0;u<i.length;u++)e=$(i[u]),e.attr("name",e.attr("name").replace(/Scopes\[([1-9]\d*)\]/,"Scopes["+t+"]"));for(o=$("tr[data-parent-index='"+c+"']",n),o.attr("data-parent-index",t),i=o.find("[name^='ApiResource.Scopes[']"),f=0;f<i.length;f++)s=$(i[f]),s.attr("name",s.attr("name").replace(/Scopes\[([1-9]\d*)\]/,"Scopes["+t+"]"))}}$(".select-user-claims").select2({theme:"bootstrap"});var i=$("section[data-scope='partials-api-resource-secrets']"),e=$.templates("#api-resource-secret-template"),o=$("#tbl-api-resource-secret",i),t=$("tbody",o),s=$("#btn-add-api-resource-secret",i);s.off("click").on("click",function(){var n=$("tr",t).length,i=new u(n),r=e.render(i);t.append($(r))});t.off("click").on("click",".btn-delete-api-resource-secret",function(n){var t=$(n.target).parents("tr:first");t.remove();h()});var r=$("section[data-scope='partials-api-resource-scopes']"),c=$.templates("#api-resource-scope-template"),l=$("#tbl-api-resource-scope",r),n=$("tbody",l),a=$("#btn-add-api-resource-scope",r);a.off("click").on("click",function(){var t=$("tr.scopeValues",n).length,u=new f(t),i=$(c.render(u)),r=$("#ddl-claims-base").clone().attr("id","").addClass("select-user-claims").attr("name","ScopeUserClaims["+(t+1)*-1+"]");i.find(".claims-cell").append(r);r.select2({theme:"bootstrap"});n.append(i)});n.off("click").on("click",".btn-delete-api-resource-scope",function(t){var i=$(t.target).parents("tr.scopeValues:first"),r=i.attr("data-index"),u=$("tr[data-parent-index='"+r+"']",n);i.remove();u.remove();v()});n.off("change").on("change","input[type='checkbox'].scopeCheckbox",function(n){var t=$(n.target),i=t.siblings(".scopeCheckboxHiddentTextValue");t.is(":checked")||t.removeAttr("checked");i.attr("value",t.is(":checked"))})});